# ADR-0002: アーキテクチャパターンの選択

## ステータス

採用

## 背景

メッセージボードアプリケーションのアーキテクチャを設計するにあたり、保守性、テスタビリティ、シンプルさのバランスを考慮する必要があった。

## 決定事項

以下のアーキテクチャパターンを採用する：

### 1. Multi Page Application (MPA)
SPAではなく、従来のMulti Page Applicationとして実装する。

**理由**:
- 要件がシンプル（メッセージ一覧表示と投稿のみ）
- JavaScriptフレームワーク（React/Vue等）が不要
- SEO・アクセシビリティが自然に確保される
- クライアントサイドの複雑性を回避

### 2. 関心の分離（Separation of Concerns）
以下の3層に明確に分離：

```
routes/   → HTTPリクエスト/レスポンス処理のみ
db/       → データアクセスロジック
views/    → HTML生成
```

**理由**:
- 各レイヤーの責務が明確
- テストが書きやすい
- 変更の影響範囲を限定

### 3. データアクセス層の独立性
データベース操作を`db/messages.ts`に集約し、ルートハンドラから分離。

**理由**:
- ビジネスロジックとHTTP処理の分離
- データアクセスロジックの単体テストが可能
- 将来的なDB変更時の影響を局所化

## 結果

### 良い点
- コードベースがシンプルで理解しやすい
- 各ファイルの責務が明確
- データアクセス層のテストが容易
- フロントエンドのビルドプロセスが不要

### 悪い点
- リッチなUI/UXの実装には限界がある
- ページ遷移時にフル再読み込みが発生

### トレードオフ
- ユーザー体験（UX）よりもシンプルさと保守性を優先
- 将来的にSPAが必要になった場合は、データアクセス層を再利用可能
